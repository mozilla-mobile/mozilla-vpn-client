#!/usr/bin/env bash
# Auto generated by: @CMAKE_CURRENT_LIST_FILE@

# First argument is the real rustc compiler tool.
RUSTC=$1
shift

# Scan through the argument list and return the value of a given argument.
find_arg_value() {
  NAME="$1"
  shift
  while [ $# -gt 0 ]; do
    ARG="$1"
    shift
    if [ "$ARG" = "$NAME" ]; then
      echo "$1"
      break
    fi
  done
}

# If the target being built matches one of the architectures, set the rustflags.
TARGET_ARCH=$(find_arg_value "--target" "$@")
for ARCH in @RUST_CONFIG_TARGETS@; do
  if [ "${ARCH}" = "${TARGET_ARCH}" ]; then
    IFS=';' read -a FLAGS <<< "@RUST_CONFIG_RUSTFLAGS@"
    ${RUSTC} "${FLAGS[@]}" "$@"
    exit $?
  fi
done

# Otherwise, invoke rust as normal
${RUSTC} "$@"
exit $?
